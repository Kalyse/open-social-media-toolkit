<?php// AdCode is the client advertising code that are placed on the siterequire_once(PATH_CORE .'/classes/dbRowObject.class.php');class AdCode extends dbRowObject{	}class AdCodeTable{		///////////////////////////////////////////////////////////////////////////////////////////////////////	// standard table fields	var $db;		static $tablename="AdCode";	static $idname = "id";	static $idtype = "INT(11) unsigned NOT NULL auto_increment";	static $dbRowObjectClass = "AdCode";			static $fields = array(						"site" => 			"varchar(50) default ''",		"clientid" => 			"INT(11) default 0",		"format" => 		"varchar(50) default ''",		"locale" => 		"varchar(100) default ''",		"code" => "TEXT default ''",		"codeType" => 		"ENUM('html','iframe') default 'iframe'",		"impRemaining" => 	"BIGINT(20) default 0", // remaining impressions		"status" => 	"ENUM('active','completed','pending') default 'pending'"		);	static $keydefinitions = array(); 		/*	 formats - 		234 x 60 halfBanner		200 x 200 smallSquare		336 x 280 largeRect		300 x 250 mediumRect		468 x 60 smallBanner		728 x 90 largeBanner		160 x 600 tallSidebar	 locales -		homeLargeBanner		homeSmallBanner		homeSidebar		anySmallBanner		anySidebar		anyLargeRect		anySidebarBottom	*/		///////////////////////////////////////////////////////////////////////////////////////////////////////	// standard table functions	function __construct(&$db=NULL) 	{		if (is_null($db)) 		{ 			require_once('db.class.php');			$this->db=new cloudDatabase();		} else			$this->db=$db;			}		// although many functions will be duplicated between table subclasses, having a parent class gets too messy		function getRowObject()	{			$classname = self::$dbRowObjectClass; 		return new $classname($this->db, self::$tablename, array_keys(self::$fields), self::$idname);	}				// generic table creation routine, same for all *Table classes 			static function createTable($manageObj)	{					$manageObj->addTable(self::$tablename,self::$idname,self::$idtype,"MyISAM");		foreach (array_keys(self::$fields) as $key)		{			$manageObj->updateAddColumn(self::$tablename,$key,self::$fields[$key]);		}		foreach (self::$keydefinitions as $keydef)		{			$manageObj->updateAddKey(self::$tablename,$keydef[0], $keydef[1], $keydef[2], $keydef[3]);		}			}		function fetch($locale='') {				switch ($locale) {			case 'homeLargeBanner':				$format='largeBanner';			break;			case 'homeSmallBanner':				$format='smallBanner';			break;			case 'anySkyscraper':				$format='skyscraper';			break;			case 'homeSidebar':				$format='smallSquare,halfBanner';			break;			case 'anyLargeBanner':				$format='largeBanner';			break;			case 'anySmallBanner':				$format='smallBanner';			break;			case 'anySidebar':				$format='smallSquare,halfBanner';				//$format=(RAND(0,1)==0? 'smallSquare' :'halfBanner');						break;			case 'anySidebarBottom':				$format='tallSidebar';			break;			case 'anyLargeRect':				$format='largeRect';			break;		}		$q=$this->db->query("SELECT * FROM AdCode WHERE locale LIKE '%".$locale."%' AND FIND_IN_SET(format,'$format') ORDER BY RAND() LIMIT 1;");		$ad=$this->db->readQ($q);		return $ad->code;				}		function placeDefaultAds() {/*		$q=$db->query("SELECT * FROM AdCode;");		if ($db->countQ($q)==0) {			$manageObj->db->insert("AdCode","site,size,clientid,code,format,locale,","'largeBanner','google','".addslashes('<script type="text/javascript"><!--google_ad_client = "pub-9975156792632579";google_alternate_ad_url = "http://www.newscloud.com/static/ads/index.php?mode=html&size=banner&site=default&exclude=google";google_ad_width = 728;google_ad_height = 90;google_ad_format = "728x90_as";google_ad_type = "image";//2007-05-12: nc_bannergoogle_ad_channel = "4088172800";google_color_border = "000000";google_color_bg = "F0F0F0";google_color_link = "0000FF";google_color_text = "000000";google_color_url = "008000";//--></script><script type="text/javascript"  src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>')."'");			$manageObj->db->insert("AdCode","size,src,code","'largeBanner','amazon','".addslashes('<script type="text/javascript"><!-- amazon_ad_tag = "newscloud_banner-20";  amazon_ad_width = "728";  amazon_ad_height = "90";  amazon_ad_logo = "hide";  amazon_ad_exclude = "";  amazon_ad_include = ""; amazon_ad_link_target = "new"; //--></script><script type="text/javascript" src="http://www.assoc-amazon.com/s/ads.js"></script>')."'");		*/	}	///////////////////////////////////////////////////////////////////////////////////////////////////////	}?>